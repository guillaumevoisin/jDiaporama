(function(b){function p(b,a){if(this.console&&typeof console.log!="undefined")switch(a){case "info":console.info("jDiaporama -> "+a+": "+b);break;case "warn":console.warn("jDiaporama -> "+a+": "+b);break;case "error":console.error("jDiaporama -> "+a+": "+b);break;default:console.error("jDiaporama -> Debug: "+b)}}var u=function(l,a){this.options=b.extend({},t,a);var c=b(l),d=!1,e=this.options.sens,g=!1,h=0,r=b("li",c).length,q="",s=["fade","slide","slidev","slideDiago","slidevInverse","sliceBarsH", "sliceBarsHAlternate","sliceBarsV","sliceBarsVAlternate","sliceBarsVFade"];isAnimating=!1;c.wrap("<div class='jDiaporama "+this.options.theme+"'><div class='jDiaporama_wrapper'><div class='jDiaporama_slider'></div></div></div>");var n=c.parent().parent().parent();this.iniMouseActions=function(){c.parent().parent().mouseenter(b.proxy(function(){d||(d=!0,this.options.onrollover&&this.displayInfos(b("li.active",c),"show"),b(".jDiaporama_controls",n).fadeIn())},this)).mouseleave(b.proxy(function(){d= !1;this.options.onrollover&&this.displayInfos(b("li.active",c),"hide");b(".jDiaporama_controls",n).hide()},this))};this.initKeyBoard=function(){b(document).keydown(b.proxy(function(a){switch(a.keyCode){case 37:this.prev();break;case 39:this.next()}},this))};this.initControls=function(){b(".jDiaporama_wrapper",n).append("<div class='jDiaporama_controls'><a href='#' class='prev'>Prec.</a> "+(this.options.auto?"<a href='#' class='pauseBtn pause'>Pause</a>":"")+" <a href='#' class='next'>Suiv.</a></div>"); b(".prev",n).click(b.proxy(function(a){a.preventDefault();this.prev();return!1},this));b(".next",n).click(b.proxy(function(a){a.preventDefault();this.next();return!1},this));b(".pauseBtn",n).click(b.proxy(function(){this.pauseSlider();return!1},this))};this.initStatusControls=function(){var a=this;this.options.statusPosition=="top"?b(".jDiaporama_wrapper",n).before("<div class='jDiaporama_status'></div>"):b(".jDiaporama_wrapper",n).after("<div class='jDiaporama_status'></div>");b("li",c).each(function(){i= parseInt(b("li",c).index(b(this))+1);bullet="<a href='#'";a.options.useThumbs&&(filename=b("img",b(this)).attr("src"),tmp=filename.split("/"),a.options.thumbsDir?(thumbname=a.options.thumbsDir+tmp[tmp.length-1],bullet+=" class='imgBack' style='background-image:url("+thumbname+")'"):this.options.debugMode&&p("Le r\u00e9pertoire des miniatures n'a pas pu \u00eatre trouv\u00e9.","error"));bullet+=">Image "+i+"</a>";b(".jDiaporama_status",n).append(bullet)});b(".jDiaporama_status",n).width(b(".jDiaporama_status", n).width());b(".jDiaporama_status a",n).click(function(){currentId=parseInt(b("li",c).index(b("li.active",c)));clickId=parseInt(b(this).parent().children().index(this));currentId!=clickId&&!isAnimating&&(e=clickId<currentId?"left":"right",a.nextImage(a.options,b("li:eq("+clickId+")",c)));return!1})};this.init=function(){var a=this;c.width(this.options.width*r);c.height(this.options.height);c.parent().width(this.options.width);c.parent().height(this.options.height);_w=c.parent().outerWidth();_h=c.parent().outerHeight(); c.parent().width(this.options.width).parent().width(_w);b("li",c).each(function(){l=b(this);b("img",l).height()>b("img",l).width()&&b("img",l).height()>a.options.height&&a.options.constraintWidth&&(ratio=a.options.width/a.options.height,b("img",l).height(b("img",l).height()/ratio));b("img",l).height()>b("img",l).width()?l.attr("data-format","portrait"):l.attr("data-format","landscape");l.width(a.options.width);l.height(a.options.height);if(a.options.infos){var d=b("img",l).attr("title")!=""&&b("img", l).attr("title")!=void 0,e=b("img",l).attr("alt")!="";d&&l.append("<p class='desc'>"+b("img",l).attr("title")+"</p>");e&&l.append("<p class='title'>"+b("img",l).attr("alt")+"</p>");a.options.currentimage&&l.append("<p class='count'>"+parseInt(b("li",c).index(l)+1)+"/"+c.children().length+"</p>")}});b("img",c).bind("click",function(){a.options.imageClick.call(this,b(this).parent())});this.options.controls&&(this.initControls(),this.iniMouseActions());this.options.keyboard&&this.initKeyBoard();this.options.status_controls&& (this.initStatusControls(),b(".jDiaporama_status a:first-child",n).addClass("active"),b(".jDiaporama_status",n).show());this.options.auto&&this.options.paused&&b(".pauseBtn",n).trigger("click");this.options.onrollover||this.displayInfos(b("li",c),"show")};this.next=function(){isAnimating||(this.options.random?this.randomImage():(l=b("li.active",c).is(":last-child")?b("li:first-child",c):b("li.active",c).next(),e="right",this.nextImage(this.options,l)))};this.prev=function(){isAnimating||(this.options.random? randomImage():(l=b("li.active",c).is(":first-child")?b("li:last-child",c):b("li.active",c).prev(),e="left",this.nextImage(this.options,l)))};this.randomImage=function(){rand=Math.floor(Math.random()*r)+1;for(id=b("li.active",c).attr("id").split("_")[2];rand==id;)rand=Math.floor(Math.random()*r)+1;nextImage(this.options,b("li#jDiaporama_image_"+rand,c))};this.pauseSlider=function(){var a=this;g?(b(".pauseBtn",n).removeClass("play").addClass("pause"),q=setInterval(function(){a.displayDiaporama(a.options)}, a.options.delay*1E3),g=!1,this.options.debugMode&&p("Diaporama resumed","info")):(b(".pauseBtn",n).removeClass("pause").addClass("play"),clearInterval(q),g=!0,this.options.debugMode&&p("Diaporama paused","info"));n.trigger("jDiaporama:pause",g)};this.displayInfos=function(a,c){var d=b("img",a).attr("title")!="",e=b("img",a).attr("alt")!="";d&&(c=="show"?b(".desc",a).slideDown("fast"):b(".desc",a).slideUp("fast"));e&&(c=="show"?b(".title",a).slideDown("fast"):b(".title",a).slideUp("fast"));this.options.currentimage&& (c=="show"?b(".count",a).slideDown("fast"):b(".count",a).slideUp("fast"))};this.createSlices=function(a){var c="";for(i=0;i<o.options.nbSlices;i++){var d=Math.round(this.options.width/o.options.nbSlices);c+=i==o.options.nbSlices-1?'<div class="jDiaporama-slice" style="left:'+d*i+"px; width:"+(this.options.width-d*i)+"px; height:"+this.options.height+"px; opacity:1; background: url("+a.attr("src")+") no-repeat -"+(d+i*d-d)+'px 0"></div>':'<div class="jDiaporama-slice" style="left:'+d*i+"px; width:"+ d+"px; height:"+this.options.height+"px; opacity:1; background: url("+a.attr("src")+") no-repeat -"+(d+i*d-d)+'px 0"></div>'}b(".fade-tmp").append(c)};this.createSlicesH=function(a){var c="";for(i=0;i<o.options.nbSlices;i++){var d=Math.round(this.options.height/o.options.nbSlices);c+=i==o.options.nbSlices-1?'<div class="jDiaporama-slice" style="top:'+d*i+"px; height:"+(this.options.height-d*i)+"px; width:"+this.options.width+"px; opacity:1; background: url("+a.attr("src")+") no-repeat 0 -"+(d+i*d- d)+'px"></div>':'<div class="jDiaporama-slice" style="top:'+d*i+"px; height:"+d+"px; width:"+this.options.width+"px; opacity:1; background: url("+a.attr("src")+") no-repeat 0 -"+(d+i*d-d)+'px"></div>'}b(".fade-tmp").append(c)};this.createBoxes=function(a){var c="";for(i=0;i<this.options.nbSlices;i++){var d=Math.round(this.options.width/o.options.nbSlices),e=Math.round(this.options.height/o.options.nbSlices);for(j=0;j<this.options.nbSlices;j++)i==o.options.nbSlices-1?(_height=j==o.options.nbSlices- 1?this.options.height-e*j:e,c+='<div class="jDiaporama-slice" style="left:'+d*i+"px; width:"+(this.options.width-d*i)+"px; top: "+e*j+"px; height:"+_height+"px; opacity:1; background:url("+a.attr("src")+") no-repeat -"+(d+i*d-d)+"px -"+(e+j*e-e)+'px"></div>'):c+='<div class="jDiaporama-slice" style="left:'+d*i+"px; width:"+d+"px; top: "+e*j+"px; height:"+e+"px; opacity:1; background:url("+a.attr("src")+") no-repeat -"+(d+i*d-d)+"px -"+(e+j*e-e)+'px"></div>'}b(".fade-tmp").append(c)};this.nextImage= function(a,l){clearInterval(q);id=b("li",c).index(l);this.options.debugMode&&p("Image #"+id+" called.","info");oldActive=b("li.active",c).clone();b("li.active",c).removeClass("active");b("li:eq("+id+")",c).addClass("active");this.options.transition=="random"?(rand=Math.floor(Math.random()*s.length),effect=s[rand]):typeof this.options.transition=="object"?(rand=Math.floor(Math.random()*this.options.transition.length),effect=this.options.transition[rand]):effect=this.options.transition;c.trigger("jDiaporama:animationStarts"); var k=this;if(effect=="fade")c.parent().prepend("<div class='fade-tmp'>"+oldActive.html()+"</div>"),c.stop().css("left",-(id*this.options.width)),b(".fade-tmp").width(this.options.width).height(this.options.height).fadeOut(this.options.animationSpeed,function(){b(this).remove();c.trigger("jDiaporama:animationEnds")}),b("li:eq("+id+")",c).hide().fadeIn(this.options.animationSpeed);else if(effect=="sliceHide"||effect=="slice"||effect=="sliceBarsVFade"||effect=="sliceBarsVAlternate"||effect=="sliceBarsV"|| effect=="sliceBarsHAlternate"||effect=="sliceBarsH"||effect=="slidevInverse"||effect=="slidev"||effect=="slide"||effect=="slideDiago")if(b(".fade-tmp")&&b(".fade-tmp").remove(),c.parent().prepend("<div class='fade-tmp'></div>"),img=b("img",oldActive),effect=="slice"||effect=="sliceHide"){this.createBoxes(img);c.stop().css("left",-(id*this.options.width));slices=b(".jDiaporama-slice");e=="left"&&(slices=slices.reverse());for(var f=0,m=0,h=slices.length;f<h;f++,m+=7)f==h-1?effect=="sliceHide"?setTimeout(function(a){return function(){b(slices[a]).hide("fast", function(){b(slices[a]).remove();b(".fade-tmp").remove();c.trigger("jDiaporama:animationEnds")})}}(f),m):setTimeout(function(a){return function(){b(slices[a]).animate({display:"none",opacity:0},k.options.animationSpeed,function(){b(slices[a]).remove();b(".fade-tmp").remove();c.trigger("jDiaporama:animationEnds")})}}(f),m):effect=="sliceHide"?setTimeout(function(a){return function(){b(slices[a]).hide("fast",function(){b(slices[a]).remove()})}}(f),m):setTimeout(function(a){return function(){b(slices[a]).animate({display:"none", opacity:0},k.options.animationSpeed,function(){b(slices[a]).remove()})}}(f),m)}else if(effect=="sliceBarsH"){this.createSlices(img);c.stop().css("left",-(id*this.options.width));slices=b(".jDiaporama-slice");e=="left"&&(slices=slices.reverse());m=f=0;for(h=slices.length;f<h;f++,m+=120)f==h-1?setTimeout(function(a){return function(){b(slices[a]).animate({height:0,opacity:0.5},500,"easeInOutExpo",function(){b(slices[a]).remove();b(".fade-tmp").remove();c.trigger("jDiaporama:animationEnds")})}}(f),m): setTimeout(function(a){return function(){b(slices[a]).animate({height:0,opacity:0.5},500,"easeInOutExpo",function(){b(this).remove()})}}(f),m)}else if(effect=="sliceBarsHAlternate"){this.createSlices(img);c.stop().css("left",-(id*k.options.width));slices=b(".jDiaporama-slice");e=="left"&&(slices=slices.reverse());m=f=0;for(h=slices.length;f<h;f++,m+=120)f%2==0?b(slices[f]).css("bottom",-k.options.height):b(slices[f]).css("top",0),f==h-1?setTimeout(function(a){return function(){b(slices[a]).animate({height:0, opacity:0.5},600,"easeInOutExpo",function(){b(slices[a]).remove();b(".fade-tmp").remove();c.trigger("jDiaporama:animationEnds")})}}(f),m):setTimeout(function(a){return function(){b(slices[a]).animate({height:0,opacity:0.5},600,"easeInOutExpo",function(){b(this).remove()})}}(f),m)}else if(effect=="sliceBarsV"){this.createSlicesH(img);c.stop().css("left",-(id*this.options.width));slices=b(".jDiaporama-slice");e=="left"&&(slices=slices.reverse());m=f=0;for(h=slices.length;f<h;f++,m+=120)f==h-1?setTimeout(function(a){return function(){b(slices[a]).animate({width:0, opacity:0.5},400,"easeInCirc",function(){b(slices[a]).remove();b(".fade-tmp").remove();c.trigger("jDiaporama:animationEnds")})}}(f),m):setTimeout(function(a){return function(){b(slices[a]).animate({width:0,opacity:0.5},400,"easeInCirc",function(){b(this).remove()})}}(f),m)}else if(effect=="sliceBarsVAlternate"){this.createSlicesH(img);c.stop().css("left",-(id*this.options.width));slices=b(".jDiaporama-slice");e=="left"&&(slices=slices.reverse());m=f=0;for(h=slices.length;f<h;f++,m+=120)f%2==0?b(slices[f]).css("right", -k.options.width):b(slices[f]).css("left",0),f==h-1?setTimeout(function(a){return function(){b(slices[a]).animate({width:0,opacity:0.5},400,"easeInCirc",function(){b(slices[a]).remove();b(".fade-tmp").remove();c.trigger("jDiaporama:animationEnds")})}}(f),m):setTimeout(function(a){return function(){b(slices[a]).animate({width:0,opacity:0.5},400,"easeInCirc",function(){b(this).remove()})}}(f),m)}else if(effect=="sliceBarsVFade"){this.createSlicesH(img);c.stop().css("left",-(id*this.options.width)); slices=b(".jDiaporama-slice");e=="left"&&(slices=slices.reverse());m=f=0;for(h=slices.length;f<h;f++,m+=120)f==h-1?setTimeout(function(a){return function(){b(slices[a]).animate({height:0,opacity:0.4},400,function(){b(slices[a]).remove();b(".fade-tmp").remove();c.trigger("jDiaporama:animationEnds")})}}(f),m):setTimeout(function(a){return function(){b(slices[a]).animate({height:0,opacity:0.4},400,function(){b(this).remove()})}}(f),m)}else effect=="slide"?c.stop().animate({left:-(id*k.options.width)}, k.options.animationSpeed,k.options.animationEasing,function(){c.trigger("jDiaporama:animationEnds")}):effect=="slideDiago"?(c.parent().prepend("<div class='fade-tmp'>"+oldActive.html()+"</div>"),b(".fade-tmp").width(k.options.width).slideUp(k.options.animationSpeed,function(){b(this).remove();c.trigger("jDiaporama:animationEnds")}),c.stop().css("top",k.options.height).animate({left:-(id*k.options.width),top:0},k.options.animationSpeed)):effect=="slidev"?(c.parent().prepend("<div class='fade-tmp'>"+ oldActive.html()+"</div>"),b(".fade-tmp .title, .fade-tmp .count, .fade-tmp .desc").remove(),c.stop().css({top:k.options.height,left:-(id*k.options.width)}).animate({top:0},k.options.animationSpeed,k.options.animationEasing),b(".fade-tmp").width(k.options.width).animate({top:-k.options.height},k.options.animationSpeed,k.options.animationEasing,function(){b(this).remove();c.trigger("jDiaporama:animationEnds")})):effect=="slidevInverse"&&(c.parent().prepend("<div class='fade-tmp'>"+oldActive.html()+ "</div>"),b(".fade-tmp .title, .fade-tmp .count, .fade-tmp .desc").remove(),c.stop().css({top:-k.options.height,left:-(id*k.options.width)}).animate({top:0},k.options.animationSpeed,k.options.animationEasing),b(".fade-tmp").width(k.options.width).animate({top:k.options.height},k.options.animationSpeed,k.options.animationEasing,function(){b(this).remove();c.trigger("jDiaporama:animationEnds")}));else c.stop().css("left",-(id*k.options.width)),c.trigger("jDiaporama:animationEnds"),k.options.debugMode&& p("Transition animation not found.","error");b(".jDiaporama_status a",n).removeClass("active");this.options.status_controls&&b(".jDiaporama_status a:eq("+id+")",n).addClass("active");this.options.infos&&d&&this.options.onrollover?k.displayInfos(b("li.active",c),"show"):!d&&this.options.onrollover&&k.displayInfos(b("li.active",c),"hide");!g&&this.options.auto&&(this.options.boucles==0||this.options.boucles>0&&c.data("current_slide")/c.children().length<this.options.boucles?q=setInterval(function(){k.displayDiaporama(this.options)}, this.options.delay*1E3):b(".pauseBtn",n).remove())};this.displayDiaporama=function(){h++;c.data("current_slide",h);e=="right"?this.next():this.prev()};c.bind("jDiaporama:animationEnds",function(){isAnimating=!1;o.options.debugMode&&p("Transition animation stops.","info");o.options.animationStops.call(this)});c.bind("jDiaporama:animationStarts",function(){isAnimating=!0;o.options.debugMode&&p("Transition animation starts.","info");o.options.animationStarts.call(this)});this.changeOption=function(a, c){this.options[a]=c};this.getOption=function(a){return this.options[a]};var o=this;this.init();this.options.debugMode&&p("jDiaporama initiated.","info");this.options.onceLoaded.call(this);this.options.auto&&!this.options.paused&&(q=setInterval(function(){o.displayDiaporama(this.options)},this.options.delay*1E3));b("li:first-child",c).addClass("active").fadeIn(this.options.animationSpeed)},t={debugMode:!1,auto:!0,delay:3,animationSpeed:"slow",controls:!0,status_controls:!0,statusPosition:"bottom", keyboard:!0,infos:!0,onrollover:!0,currentimage:!0,paused:!0,boucles:0,sens:"right",random:!1,transition:"random",animationEasing:"easeInQuint",theme:"default",useThumbs:!1,thumbsDir:null,constraintWidth:!0,nbSlices:10,onceLoaded:function(){},animationStarts:function(){},animationStops:function(){},imageClick:function(){}};b.fn.jDiaporama=function(l){return this.each(function(a,c){var d=new u(this,l);b(c).data("jDiaporama",d)})};b.fn.reverse=[].reverse;jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing, {def:"easeOutQuad",swing:function(b,a,c,d,e){return jQuery.easing[jQuery.easing.def](b,a,c,d,e)},easeInQuad:function(b,a,c,d,e){return d*(a/=e)*a+c},easeOutQuad:function(b,a,c,d,e){return-d*(a/=e)*(a-2)+c},easeInOutQuad:function(b,a,c,d,e){if((a/=e/2)<1)return d/2*a*a+c;return-d/2*(--a*(a-2)-1)+c},easeInCubic:function(b,a,c,d,e){return d*(a/=e)*a*a+c},easeOutCubic:function(b,a,c,d,e){return d*((a=a/e-1)*a*a+1)+c},easeInOutCubic:function(b,a,c,d,e){if((a/=e/2)<1)return d/2*a*a*a+c;return d/2*((a-= 2)*a*a+2)+c},easeInQuart:function(b,a,c,d,e){return d*(a/=e)*a*a*a+c},easeOutQuart:function(b,a,c,d,e){return-d*((a=a/e-1)*a*a*a-1)+c},easeInOutQuart:function(b,a,c,d,e){if((a/=e/2)<1)return d/2*a*a*a*a+c;return-d/2*((a-=2)*a*a*a-2)+c},easeInQuint:function(b,a,c,d,e){return d*(a/=e)*a*a*a*a+c},easeOutQuint:function(b,a,c,d,e){return d*((a=a/e-1)*a*a*a*a+1)+c},easeInOutQuint:function(b,a,c,d,e){if((a/=e/2)<1)return d/2*a*a*a*a*a+c;return d/2*((a-=2)*a*a*a*a+2)+c},easeInSine:function(b,a,c,d,e){return-d* Math.cos(a/e*(Math.PI/2))+d+c},easeOutSine:function(b,a,c,d,e){return d*Math.sin(a/e*(Math.PI/2))+c},easeInOutSine:function(b,a,c,d,e){return-d/2*(Math.cos(Math.PI*a/e)-1)+c},easeInExpo:function(b,a,c,d,e){return a==0?c:d*Math.pow(2,10*(a/e-1))+c},easeOutExpo:function(b,a,c,d,e){return a==e?c+d:d*(-Math.pow(2,-10*a/e)+1)+c},easeInOutExpo:function(b,a,c,d,e){if(a==0)return c;if(a==e)return c+d;if((a/=e/2)<1)return d/2*Math.pow(2,10*(a-1))+c;return d/2*(-Math.pow(2,-10*--a)+2)+c},easeInCirc:function(b, a,c,d,e){return-d*(Math.sqrt(1-(a/=e)*a)-1)+c},easeOutCirc:function(b,a,c,d,e){return d*Math.sqrt(1-(a=a/e-1)*a)+c},easeInOutCirc:function(b,a,c,d,e){if((a/=e/2)<1)return-d/2*(Math.sqrt(1-a*a)-1)+c;return d/2*(Math.sqrt(1-(a-=2)*a)+1)+c},easeInElastic:function(b,a,c,d,e){var b=1.70158,g=0,h=d;if(a==0)return c;if((a/=e)==1)return c+d;g||(g=e*0.3);h<Math.abs(d)?(h=d,b=g/4):b=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin((a*e-b)*2*Math.PI/g))+c},easeOutElastic:function(b,a,c, d,e){var b=1.70158,g=0,h=d;if(a==0)return c;if((a/=e)==1)return c+d;g||(g=e*0.3);h<Math.abs(d)?(h=d,b=g/4):b=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*a)*Math.sin((a*e-b)*2*Math.PI/g)+d+c},easeInOutElastic:function(b,a,c,d,e){var b=1.70158,g=0,h=d;if(a==0)return c;if((a/=e/2)==2)return c+d;g||(g=e*0.3*1.5);h<Math.abs(d)?(h=d,b=g/4):b=g/(2*Math.PI)*Math.asin(d/h);if(a<1)return-0.5*h*Math.pow(2,10*(a-=1))*Math.sin((a*e-b)*2*Math.PI/g)+c;return h*Math.pow(2,-10*(a-=1))*Math.sin((a*e-b)*2* Math.PI/g)*0.5+d+c},easeInBack:function(b,a,c,d,e,g){g==void 0&&(g=1.70158);return d*(a/=e)*a*((g+1)*a-g)+c},easeOutBack:function(b,a,c,d,e,g){g==void 0&&(g=1.70158);return d*((a=a/e-1)*a*((g+1)*a+g)+1)+c},easeInOutBack:function(b,a,c,d,e,g){g==void 0&&(g=1.70158);if((a/=e/2)<1)return d/2*a*a*(((g*=1.525)+1)*a-g)+c;return d/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+c},easeInBounce:function(b,a,c,d,e){return d-jQuery.easing.easeOutBounce(b,e-a,0,d,e)+c},easeOutBounce:function(b,a,c,d,e){return(a/=e)<1/2.75? d*7.5625*a*a+c:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+0.75)+c:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+0.9375)+c:d*(7.5625*(a-=2.625/2.75)*a+0.984375)+c},easeInOutBounce:function(b,a,c,d,e){if(a<e/2)return jQuery.easing.easeInBounce(b,a*2,0,d,e)*0.5+c;return jQuery.easing.easeOutBounce(b,a*2-e,0,d,e)*0.5+d*0.5+c}})})(jQuery);